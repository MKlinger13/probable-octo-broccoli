<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Slides Template Generator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.2/babel.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Inter', system-ui, sans-serif; background: #f1f5f9; }
    button { cursor: pointer; font-family: inherit; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const PALETTES = [
      { name: "Slate", bg: "#FFFFFF", accent: "#334155", text: "#1e293b", muted: "#64748b", surface: "#f8fafc" },
      { name: "Collegiate Crimson", bg: "#FFFFFF", accent: "#A50034", text: "#1a0008", muted: "#8B6914", surface: "#fdf5f0" },
      { name: "Ocean & Sand", bg: "#FAFAF7", accent: "#0077B6", text: "#023e6b", muted: "#8B6000", surface: "#e8f4fd" },
      { name: "Forest & Gold", bg: "#FAFEFA", accent: "#2D6A4F", text: "#1b3a2d", muted: "#7A6000", surface: "#e8f5ee" },
      { name: "Plum & Cream", bg: "#FAF8FF", accent: "#6B3FA0", text: "#2e1a47", muted: "#8B6914", surface: "#f3eeff" },
      { name: "Dark", bg: "#0f172a", accent: "#38bdf8", text: "#f1f5f9", muted: "#94a3b8", surface: "#1e293b" },
    ];

    const FONTS = [
      { name: "Modern Sans", heading: "'Inter', sans-serif", body: "'Inter', sans-serif" },
      { name: "Classic Serif", heading: "'Georgia', serif", body: "'Georgia', serif" },
      { name: "Editorial", heading: "'Playfair Display', serif", body: "'Source Sans Pro', sans-serif" },
      { name: "Technical", heading: "'Roboto Mono', monospace", body: "'Roboto', sans-serif" },
    ];

    const SLIDE_RATIO = 16 / 9;
    const PREVIEW_W = 480;
    const PREVIEW_H = PREVIEW_W / SLIDE_RATIO;

    function hexToRgb(hex) {
      const r = parseInt(hex.slice(1,3),16);
      const g = parseInt(hex.slice(3,5),16);
      const b = parseInt(hex.slice(5,7),16);
      return {r,g,b};
    }

    function SlidePreview({ type, palette: p, font: f, active }) {
      const base = {
        width: PREVIEW_W, height: PREVIEW_H,
        background: p.bg, fontFamily: f.body,
        position: "relative", overflow: "hidden",
        border: active ? `2px solid ${p.accent}` : "2px solid transparent",
        borderRadius: 8, boxShadow: "0 4px 24px rgba(0,0,0,0.10)",
        flexShrink: 0, transition: "border 0.2s",
      };

      if (type === "title") return (
        <div style={base}>
          <div style={{ position: "absolute", inset: 0, background: p.accent }} />
          <div style={{
            position: "absolute", top: 18, left: 20, right: 20, bottom: 18,
            background: p.bg, borderRadius: 6,
            boxShadow: "0 8px 40px rgba(0,0,0,0.18)",
            display: "flex", flexDirection: "column", justifyContent: "center", padding: "0 44px",
          }}>
            <div style={{ width: "100%", height: 1, background: p.accent, opacity: 0.2, marginBottom: 22 }} />
            <div style={{ fontFamily: f.heading, fontSize: 34, fontWeight: 700, color: p.text, lineHeight: 1.1, marginBottom: 22 }}>Your Presentation Title</div>
            <div style={{ width: "100%", height: 1, background: p.accent, opacity: 0.2, marginBottom: 16 }} />
            <div style={{ fontFamily: f.body, fontSize: 13, color: p.muted, letterSpacing: "0.04em" }}>Subtitle · Name · Date</div>
          </div>
        </div>
      );

      if (type === "intro") return (
        <div style={base}>
          <div style={{ position: "absolute", top: 0, left: 0, right: 0, height: "45%", background: p.accent }} />
          <div style={{ position: "absolute", top: "38%", left: 48, right: 48 }}>
            <div style={{ background: p.bg, borderRadius: 6, padding: "22px 28px", boxShadow: "0 2px 16px rgba(0,0,0,0.10)" }}>
              <div style={{ fontFamily: f.heading, fontSize: 22, fontWeight: 700, color: p.text, marginBottom: 8 }}>Section Title</div>
              <div style={{ width: "100%", height: 1, background: p.accent, opacity: 0.2, marginBottom: 10 }} />
              <div style={{ fontFamily: f.body, fontSize: 12, color: p.muted, lineHeight: 1.6 }}>A short description of this section goes here. Keep it concise and impactful.</div>
            </div>
          </div>
        </div>
      );

      if (type === "text") return (
        <div style={{ ...base, padding: "32px 48px" }}>
          <div style={{ fontFamily: f.heading, fontSize: 22, fontWeight: 700, color: p.text, marginBottom: 10 }}>Slide Heading</div>
          <div style={{ width: "100%", height: 1, background: p.accent, opacity: 0.2, marginBottom: 18 }} />
          {["Key point one — expand on this idea here", "Second insight — add supporting detail", "Third takeaway — keep it brief and clear"].map((t, i) => (
            <div key={i} style={{ display: "flex", alignItems: "flex-start", gap: 10, marginBottom: 13 }}>
              <div style={{ width: 7, height: 7, borderRadius: "50%", background: p.accent, marginTop: 5, flexShrink: 0 }} />
              <div style={{ fontFamily: f.body, fontSize: 13, color: p.text, lineHeight: 1.6 }}>{t}</div>
            </div>
          ))}
        </div>
      );

      if (type === "split") {
        const {r,g,b} = hexToRgb(p.accent);
        return (
          <div style={{ ...base, display: "flex" }}>
            <div style={{ flex: 1, padding: "32px 32px 32px 44px", display: "flex", flexDirection: "column", justifyContent: "center" }}>
              <div style={{ fontFamily: f.heading, fontSize: 19, fontWeight: 700, color: p.text, marginBottom: 10 }}>Split Layout</div>
              <div style={{ width: "100%", height: 1, background: p.accent, opacity: 0.2, marginBottom: 14 }} />
              <div style={{ fontFamily: f.body, fontSize: 12, color: p.text, lineHeight: 1.7, marginBottom: 14 }}>Use this layout to pair a visual with supporting text. Great for data, diagrams, or imagery.</div>
              <div style={{ fontFamily: f.body, fontSize: 11, color: p.muted }}>Additional note or caption here</div>
            </div>
            <div style={{
              width: "42%",
              background: `linear-gradient(135deg, rgba(${r},${g},${b},1) 0%, rgba(${r},${g},${b},0.78) 100%)`,
              display: "flex", alignItems: "center", justifyContent: "center", flexDirection: "column", gap: 10,
              position: "relative", overflow: "hidden",
            }}>
              <div style={{ position: "absolute", inset: 0, background: `radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.12) 0%, transparent 60%)` }} />
              <svg width="36" height="36" viewBox="0 0 24 24" fill="none" style={{ opacity: 0.7 }}>
                <rect x="3" y="3" width="18" height="18" rx="2" stroke="white" strokeWidth="1.5"/>
                <circle cx="8.5" cy="8.5" r="1.5" stroke="white" strokeWidth="1.5"/>
                <path d="M21 15l-5-5L5 21" stroke="white" strokeWidth="1.5" strokeLinecap="round" strokeLinejoin="round"/>
              </svg>
              <div style={{ fontFamily: f.body, fontSize: 10, color: "rgba(255,255,255,0.75)", letterSpacing: "0.08em", textTransform: "uppercase" }}>Insert image</div>
            </div>
          </div>
        );
      }
    }

    const SLIDE_TYPES = ["title", "intro", "text", "split"];
    const SLIDE_LABELS = ["Title", "Intro", "Text", "Split"];

    function App() {
      const [palette, setPalette] = useState(0);
      const [fontIdx, setFontIdx] = useState(0);
      const [active, setActive] = useState(0);
      const [downloading, setDownloading] = useState(false);
      const [toast, setToast] = useState(false);

      const p = PALETTES[palette];
      const f = FONTS[fontIdx];

      async function handleDownload() {
        setDownloading(true);
        try {
          if (!window.PptxGenJS) throw new Error("PptxGenJS library didn't load. Please refresh and try again.");
          const pptx = new window.PptxGenJS();
          pptx.layout = "LAYOUT_16x9";
          const fontH = f.heading.includes("Georgia") || f.heading.includes("Playfair") ? "Times New Roman" : f.heading.includes("Mono") ? "Courier New" : "Calibri";
          const fontB = f.body.includes("Georgia") ? "Times New Roman" : f.body.includes("Mono") ? "Courier New" : "Calibri";
          const toHex = c => c.replace("#", "");

          // Slide 1: Title
          {
            const s = pptx.addSlide();
            s.background = { color: toHex(p.accent) };
            s.addShape(pptx.ShapeType.rect, { x:0.22, y:0.25, w:9.56, h:5.13, fill:{ color:toHex(p.bg) }, line:{ color:toHex(p.bg) }, shadow:{ type:"outer", color:"333333", blur:16, offset:4, angle:45 } });
            s.addShape(pptx.ShapeType.rect, { x:0.65, y:1.35, w:8.7, h:0.01, fill:{ color:toHex(p.accent), transparency:50 } });
            s.addText("Your Presentation Title", { x:0.65, y:1.55, w:8.7, h:1.4, fontSize:40, bold:true, color:toHex(p.text), fontFace:fontH, valign:"middle" });
            s.addShape(pptx.ShapeType.rect, { x:0.65, y:3.05, w:8.7, h:0.01, fill:{ color:toHex(p.accent), transparency:50 } });
            s.addText("Subtitle · Name · Date", { x:0.65, y:3.2, w:6, h:0.5, fontSize:14, color:toHex(p.muted), fontFace:fontB, charSpacing:1 });
          }

          // Slide 2: Intro
          {
            const s = pptx.addSlide();
            s.background = { color: toHex(p.bg) };
            s.addShape(pptx.ShapeType.rect, { x:0, y:0, w:10, h:2.5, fill:{ color:toHex(p.accent) } });
            s.addShape(pptx.ShapeType.rect, { x:0.6, y:1.8, w:8.8, h:2.6, fill:{ color:toHex(p.bg) }, shadow:{ type:"outer", color:"888888", blur:8, offset:2, angle:45 } });
            s.addText("Section Title", { x:0.9, y:2.1, w:8, h:0.7, fontSize:26, bold:true, color:toHex(p.text), fontFace:fontH });
            s.addShape(pptx.ShapeType.rect, { x:0.9, y:2.85, w:7.8, h:0.01, fill:{ color:toHex(p.accent), transparency:50 } });
            s.addText("A short description of this section goes here. Keep it concise and impactful.", { x:0.9, y:3.0, w:8, h:0.9, fontSize:14, color:toHex(p.muted), fontFace:fontB });
          }

          // Slide 3: Text
          {
            const s = pptx.addSlide();
            s.background = { color: toHex(p.bg) };
            s.addText("Slide Heading", { x:0.6, y:0.5, w:8, h:0.7, fontSize:28, bold:true, color:toHex(p.text), fontFace:fontH });
            s.addShape(pptx.ShapeType.rect, { x:0.6, y:1.25, w:8.8, h:0.01, fill:{ color:toHex(p.accent), transparency:50 } });
            const bullets = ["Key point one — expand on this idea here","Second insight — add supporting detail","Third takeaway — keep it brief and clear"];
            bullets.forEach((b2, i) => {
              s.addShape(pptx.ShapeType.ellipse, { x:0.6, y:1.65+i*0.85, w:0.1, h:0.1, fill:{ color:toHex(p.accent) } });
              s.addText(b2, { x:0.85, y:1.58+i*0.85, w:8.5, h:0.6, fontSize:15, color:toHex(p.text), fontFace:fontB });
            });
          }

          // Slide 4: Split
          {
            const s = pptx.addSlide();
            s.background = { color: toHex(p.bg) };
            s.addText("Split Layout", { x:0.5, y:0.8, w:5.2, h:0.7, fontSize:24, bold:true, color:toHex(p.text), fontFace:fontH });
            s.addShape(pptx.ShapeType.rect, { x:0.5, y:1.55, w:4.9, h:0.01, fill:{ color:toHex(p.accent), transparency:50 } });
            s.addText("Use this layout to pair a visual with supporting text. Great for data, diagrams, or imagery.", { x:0.5, y:1.75, w:5, h:1.2, fontSize:13, color:toHex(p.text), fontFace:fontB });
            s.addShape(pptx.ShapeType.rect, { x:5.8, y:0.3, w:3.9, h:5.0, fill:{ color:toHex(p.accent) } });
            s.addText("Insert image", { x:5.8, y:2.55, w:3.9, h:0.4, align:"center", fontSize:11, color:"FFFFFF", fontFace:fontB, charSpacing:2 });
          }

          await pptx.writeFile({ fileName: "slides-template.pptx" });
          setToast(true);
          setTimeout(() => setToast(false), 3000);
        } catch(e) {
          alert("Download failed: " + e.message);
        }
        setDownloading(false);
      }

      return (
        <div style={{ minHeight:"100vh", background:"#f1f5f9" }}>
          {/* Header */}
          <div style={{ background:"#fff", borderBottom:"1px solid #e2e8f0", padding:"18px 32px", display:"flex", alignItems:"center", justifyContent:"space-between" }}>
            <div>
              <div style={{ fontWeight:700, fontSize:18, color:"#0f172a" }}>Slides Template Generator</div>
              <div style={{ fontSize:12, color:"#94a3b8", marginTop:2 }}>Customize, preview, and download a PPTX ready for Google Slides</div>
            </div>
            <button onClick={handleDownload} disabled={downloading} style={{ background:"#334155", color:"#fff", border:"none", borderRadius:8, padding:"10px 22px", fontWeight:600, fontSize:14, cursor:downloading?"not-allowed":"pointer", opacity:downloading?0.7:1 }}>
              {downloading ? "Generating…" : "↓ Download PPTX"}
            </button>
          </div>

          <div style={{ display:"flex", height:"calc(100vh - 65px)" }}>
            {/* Sidebar */}
            <div style={{ width:240, background:"#fff", borderRight:"1px solid #e2e8f0", padding:24, overflowY:"auto", flexShrink:0 }}>
              <div style={{ fontSize:11, fontWeight:700, color:"#94a3b8", letterSpacing:1, marginBottom:12 }}>COLOR PALETTE</div>
              <div style={{ display:"flex", flexDirection:"column", gap:8, marginBottom:28 }}>
                {PALETTES.map((pal, i) => (
                  <button key={i} onClick={() => setPalette(i)} style={{ display:"flex", alignItems:"center", gap:10, padding:"8px 10px", borderRadius:7, border:palette===i?`2px solid ${pal.accent}`:"2px solid #e2e8f0", background:palette===i?pal.surface:"#fff", cursor:"pointer" }}>
                    <div style={{ display:"flex", gap:3 }}>
                      {[pal.accent, pal.text, pal.muted].map((c,j) => <div key={j} style={{ width:12, height:12, borderRadius:"50%", background:c }} />)}
                    </div>
                    <span style={{ fontSize:13, fontWeight:500, color:"#334155" }}>{pal.name}</span>
                  </button>
                ))}
              </div>
              <div style={{ fontSize:11, fontWeight:700, color:"#94a3b8", letterSpacing:1, marginBottom:12 }}>FONT PAIRING</div>
              <div style={{ display:"flex", flexDirection:"column", gap:8 }}>
                {FONTS.map((font, i) => (
                  <button key={i} onClick={() => setFontIdx(i)} style={{ padding:"8px 10px", borderRadius:7, border:fontIdx===i?`2px solid ${p.accent}`:"2px solid #e2e8f0", background:fontIdx===i?p.surface:"#fff", cursor:"pointer", textAlign:"left" }}>
                    <div style={{ fontSize:13, fontWeight:600, color:"#334155", fontFamily:font.heading }}>{font.name}</div>
                    <div style={{ fontSize:11, color:"#94a3b8", marginTop:2 }}>{font.heading.split("'")[1]||font.heading.split(",")[0]}</div>
                  </button>
                ))}
              </div>
            </div>

            {/* Main */}
            <div style={{ flex:1, display:"flex", flexDirection:"column", overflow:"hidden" }}>
              <div style={{ display:"flex", borderBottom:"1px solid #e2e8f0", background:"#fff", padding:"0 24px" }}>
                {SLIDE_LABELS.map((label, i) => (
                  <button key={i} onClick={() => setActive(i)} style={{ padding:"14px 20px", fontSize:13, fontWeight:active===i?600:400, color:active===i?p.accent:"#64748b", background:"none", border:"none", borderBottom:active===i?`2px solid ${p.accent}`:"2px solid transparent", cursor:"pointer" }}>
                    {label}
                  </button>
                ))}
              </div>
              <div style={{ flex:1, display:"flex", alignItems:"center", justifyContent:"center", padding:40, background:"#f1f5f9" }}>
                <SlidePreview type={SLIDE_TYPES[active]} palette={p} font={f} active />
              </div>
              <div style={{ background:"#fff", borderTop:"1px solid #e2e8f0", padding:"16px 24px", display:"flex", gap:12, overflowX:"auto" }}>
                {SLIDE_TYPES.map((type, i) => (
                  <div key={i} onClick={() => setActive(i)} style={{ cursor:"pointer", opacity:active===i?1:0.65, transform:active===i?"scale(1.03)":"scale(1)", flexShrink:0 }}>
                    <div style={{ transform:`scale(${120/PREVIEW_W})`, transformOrigin:"top left", width:PREVIEW_W, height:PREVIEW_H, pointerEvents:"none" }}>
                      <SlidePreview type={type} palette={p} font={f} active={active===i} />
                    </div>
                    <div style={{ width:120, textAlign:"center", fontSize:11, color:active===i?p.accent:"#94a3b8", marginTop:4, fontWeight:active===i?600:400 }}>{SLIDE_LABELS[i]}</div>
                  </div>
                ))}
              </div>
            </div>
          </div>

          {toast && (
            <div style={{ position:"fixed", bottom:24, right:24, background:"#0f172a", color:"#fff", padding:"12px 20px", borderRadius:8, fontSize:14, fontWeight:500, boxShadow:"0 4px 16px rgba(0,0,0,0.2)", zIndex:999 }}>
              ✓ slides-template.pptx downloaded!
            </div>
          )}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>
